# MiniHttpServer ‚Äî –¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–π—Ç (–û—Ç–µ–ª–∏)

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —É—á–µ–±–Ω—ã–π —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–π—Ç —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –æ—Ç–µ–ª–µ–π, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π ORM, —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–æ–º, –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é –∏ —Å–∞–º–æ–ø–∏—Å–Ω—ã–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–º –Ω–∞ HttpListener.

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ PostgreSQL ‚Äî –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π –±–∞–∑—ã.  
–í—ë—Ä—Å—Ç–∫–∞ –∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –Ω–∞ —á–∏—Å—Ç–æ–º HTML, CSS –∏ JavaScript.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü—É–±–ª–∏—á–Ω—ã–π —Å–∞–π—Ç (—Å–ø–∏—Å–æ–∫ –æ—Ç–µ–ª–µ–π, –¥–µ—Ç–∞–ª–∏ –æ—Ç–µ–ª—è, –≥–∞–ª–µ—Ä–µ—è, –ø–æ–∏—Å–∫).
- –ü–æ–ª–Ω–æ—Å—Ç—å—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î.
- AJAX —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ AJAX –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã).
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å (CRUD –æ—Ç–µ–ª–µ–π, –æ–ø–∏—Å–∞–Ω–∏–µ, —É—Å–ª—É–≥–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏).
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (Admin / Employee / User).
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π HTML-—à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä: –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —É—Å–ª–æ–≤–∏—è, —Ü–∏–∫–ª—ã.
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è ORM: CRUD, Where(Expression), –º–∞–ø–ø–∏–Ω–≥ –æ–±—ä–µ–∫—Ç–æ–≤.
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–∞ HttpListener: —Ä–æ—É—Ç–∏–Ω–≥, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã, —Å–µ—Å—Å–∏–∏.
- –ß–∏—Å—Ç—ã–π JavaScript –±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
MiniHttpServer/
‚îÇ
‚îú‚îÄ‚îÄ Endpoints/          # –ú–∞—Ä—à—Ä—É—Ç—ã (–∞–Ω–∞–ª–æ–≥ MVC –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤)
‚îú‚îÄ‚îÄ Model/              # –î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (Hotel, City, Country ‚Ä¶)
‚îú‚îÄ‚îÄ DTOs/               # –û–±—ä–µ–∫—Ç—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ Services/           # –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ Validators/         # –°–µ—Ä–≤–µ—Ä–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Template/           # .thtml —à–∞–±–ª–æ–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü
‚îú‚îÄ‚îÄ Public/             # HTML, CSS, JS (–∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å)
‚îÇ
‚îú‚îÄ‚îÄ MiniHttpServer.Framework/
‚îÇ   ‚îú‚îÄ‚îÄ Server/         # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è HttpListener —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ Handlers/       # –†–æ—É—Ç–∏–Ω–≥, —Å—Ç–∞—Ç–∏–∫–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ Attributes/     # HttpGet, HttpPost, Endpoint –∏ —Ç.–ø.
‚îÇ   ‚îî‚îÄ‚îÄ Settings/       # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–ø–æ—Ä—Ç, –¥–æ–º–µ–Ω, –ë–î)
‚îÇ
‚îú‚îÄ‚îÄ MyORMContext/       # –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è ORM
‚îú‚îÄ‚îÄ MiniHttpServer.Data/# –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (Repository/DAO)
‚îî‚îÄ‚îÄ Tests/              # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
```

---

## üóÑ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL

1. –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

```sql
CREATE DATABASE onetouche;
```

-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.cities
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    countryid integer NOT NULL,
    CONSTRAINT cities_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.countries
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT countries_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.hotel_categories
(
    id serial NOT NULL,
    name character varying(150) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT hotel_categories_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.hotel_category_map
(
    hotelid integer NOT NULL,
    categoryid integer NOT NULL,
    CONSTRAINT hotel_category_map_pkey PRIMARY KEY (hotelid, categoryid)
);

CREATE TABLE IF NOT EXISTS public.hotel_mealplans
(
    hotelid integer NOT NULL,
    mealplanid integer NOT NULL,
    CONSTRAINT hotel_mealplans_pkey PRIMARY KEY (hotelid, mealplanid)
);

CREATE TABLE IF NOT EXISTS public.hoteldescriptions
(
    id serial NOT NULL,
    hotelid integer NOT NULL,
    yearopened integer,
    yearrenovated integer,
    totalareasquaremeters numeric(10, 2),
    buildinginfo text COLLATE pg_catalog."default",
    CONSTRAINT hoteldescriptions_pkey PRIMARY KEY (id),
    CONSTRAINT hoteldescriptions_hotelid_key UNIQUE (hotelid)
);

CREATE TABLE IF NOT EXISTS public.hotelplaceinfos
(
    id serial NOT NULL,
    hotelid integer NOT NULL,
    address character varying(255) COLLATE pg_catalog."default",
    city character varying(100) COLLATE pg_catalog."default",
    country character varying(100) COLLATE pg_catalog."default",
    distancetoairport character varying(100) COLLATE pg_catalog."default",
    distancetocenter character varying(100) COLLATE pg_catalog."default",
    distancetobeach character varying(100) COLLATE pg_catalog."default",
    CONSTRAINT hotelplaceinfos_pkey PRIMARY KEY (id),
    CONSTRAINT hotelplaceinfos_hotelid_key UNIQUE (hotelid)
);

CREATE TABLE IF NOT EXISTS public.hotels
(
    id serial NOT NULL,
    name character varying(150) COLLATE pg_catalog."default" NOT NULL,
    slug character varying(150) COLLATE pg_catalog."default" NOT NULL,
    cityid integer NOT NULL,
    hoteltype character varying(50) COLLATE pg_catalog."default" NOT NULL,
    description text COLLATE pg_catalog."default" NOT NULL,
    photourl character varying(255) COLLATE pg_catalog."default" NOT NULL,
    mealplancode character varying(20) COLLATE pg_catalog."default",
    price integer NOT NULL,
    contacts text[] COLLATE pg_catalog."default",
    CONSTRAINT hotels_pkey PRIMARY KEY (id),
    CONSTRAINT hotels_slug_key UNIQUE (slug)
);

CREATE TABLE IF NOT EXISTS public.hotelservices
(
    id serial NOT NULL,
    hotelid integer NOT NULL,
    category character varying(50) COLLATE pg_catalog."default" NOT NULL,
    name character varying(150) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT hotelservices_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.mealplans
(
    id serial NOT NULL,
    code character varying(20) COLLATE pg_catalog."default" NOT NULL,
    description character varying(255) COLLATE pg_catalog."default" NOT NULL,
    smokingallowedinrestaurant boolean NOT NULL DEFAULT false,
    CONSTRAINT mealplans_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.roomtypes
(
    id serial NOT NULL,
    hotelid integer NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    view character varying(100) COLLATE pg_catalog."default" NOT NULL,
    bedconfiguration character varying(150) COLLATE pg_catalog."default" NOT NULL,
    maxoccupancy integer NOT NULL,
    areasquaremeters integer NOT NULL,
    CONSTRAINT roomtypes_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS public.users
(
    id serial NOT NULL,
    name character varying(100) COLLATE pg_catalog."default" NOT NULL,
    email character varying(120) COLLATE pg_catalog."default" NOT NULL,
    passwordhash character varying(255) COLLATE pg_catalog."default" NOT NULL,
    role character varying(50) COLLATE pg_catalog."default" NOT NULL DEFAULT 'User'::character varying,
    createdat timestamp with time zone NOT NULL DEFAULT now(),
    login character varying(50) COLLATE pg_catalog."default" NOT NULL,
    phone character varying(30) COLLATE pg_catalog."default" NOT NULL DEFAULT ''::character varying,
    CONSTRAINT users_pkey PRIMARY KEY (id),
    CONSTRAINT users_email_key UNIQUE (email),
    CONSTRAINT users_login_key UNIQUE (login)
);

ALTER TABLE IF EXISTS public.cities
    ADD CONSTRAINT cities_countryid_fkey FOREIGN KEY (countryid)
    REFERENCES public.countries (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS ix_cities_countryid
    ON public.cities(countryid);


ALTER TABLE IF EXISTS public.hotel_category_map
    ADD CONSTRAINT hotel_category_map_category_id_fkey FOREIGN KEY (categoryid)
    REFERENCES public.hotel_categories (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.hotel_category_map
    ADD CONSTRAINT hotel_category_map_hotel_id_fkey FOREIGN KEY (hotelid)
    REFERENCES public.hotels (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.hotel_mealplans
    ADD CONSTRAINT hotel_mealplans_hotelid_fkey FOREIGN KEY (hotelid)
    REFERENCES public.hotels (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.hotel_mealplans
    ADD CONSTRAINT hotel_mealplans_mealplanid_fkey FOREIGN KEY (mealplanid)
    REFERENCES public.mealplans (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;


ALTER TABLE IF EXISTS public.hoteldescriptions
    ADD CONSTRAINT hoteldescriptions_hotelid_fkey FOREIGN KEY (hotelid)
    REFERENCES public.hotels (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;
CREATE INDEX IF NOT EXISTS hoteldescriptions_hotelid_key
    ON public.hoteldescriptions(hotelid);


ALTER TABLE IF EXISTS public.hotelplaceinfos
    ADD CONSTRAINT hotelplaceinfos_hotelid_fkey FOREIGN KEY (hotelid)
    REFERENCES public.hotels (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;
CREATE INDEX IF NOT EXISTS hotelplaceinfos_hotelid_key
    ON public.hotelplaceinfos(hotelid);


ALTER TABLE IF EXISTS public.hotels
    ADD CONSTRAINT hotels_cityid_fkey FOREIGN KEY (cityid)
    REFERENCES public.cities (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;
CREATE INDEX IF NOT EXISTS ix_hotels_cityid
    ON public.hotels(cityid);


ALTER TABLE IF EXISTS public.hotelservices
    ADD CONSTRAINT hotelservices_hotelid_fkey FOREIGN KEY (hotelid)
    REFERENCES public.hotels (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;
CREATE INDEX IF NOT EXISTS ix_hotelservices_hotelid
    ON public.hotelservices(hotelid);


ALTER TABLE IF EXISTS public.roomtypes
    ADD CONSTRAINT roomtypes_hotelid_fkey FOREIGN KEY (hotelid)
    REFERENCES public.hotels (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE CASCADE;
CREATE INDEX IF NOT EXISTS ix_roomtypes_hotelid
    ON public.roomtypes(hotelid);

END;

2. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª:

```
MiniHttpServer.Framework/Settings/settings.json
```

3. –£–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```json
{
  "Domain": "localhost",
  "Port": "1337",
  "ConectionString": "Host=localhost;Port=5432;Database=onetouche;Username=postgres;Password=PASSWORD"
}
```

---

## ‚ñ∂ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å **.NET 9 SDK**  
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å **PostgreSQL**  
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è  
4. –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:

```bash
cd MiniHttpServer
dotnet run
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É:

```
http://localhost:1337/
```

---

## üåê –ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

| –û–ø–∏—Å–∞–Ω–∏–µ | –ü—É—Ç—å |
|---------|------|
| –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ | `/Public/index.html` |
| –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | `/Public/autorization.html` |
| –°–ø–∏—Å–æ–∫ –æ—Ç–µ–ª–µ–π | `/hotels` |
| –î–µ—Ç–∞–ª–∏ –æ—Ç–µ–ª—è | `/hotels/{id}` |

---

## üîë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å

–ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:

```
/admin
```

–§—É–Ω–∫—Ü–∏–∏:

- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –æ—Ç–µ–ª–µ–π  
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ / —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ / —É–¥–∞–ª–µ–Ω–∏–µ  
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫, —É—Å–ª—É–≥, –∫–∞—Ç–µ–≥–æ—Ä–∏–π  
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π (Admin / Employee)

---

## üì° AJAX-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- AJAX –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (`POST /auth/login`)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –æ—Ç–µ–ª–µ–π
- –ü–æ–¥–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ API
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

---

## üß© –®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä (.thtml)

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ  
```
${Hotel.Name}
```

### –£—Å–ª–æ–≤–∏—è  
```
@if(Model.HasDiscount) { ... }
```

### –¶–∏–∫–ª—ã  
```
@foreach(var item in Model.Items) { ... }
```

---

## üß™ –¢–µ—Å—Ç—ã

–ó–∞–ø—É—Å–∫:

```bash
dotnet test
```

–ü–æ–∫—Ä—ã—Ç–æ —Ç–µ—Å—Ç–∞–º–∏:

- –¥–≤–∏–∂–æ–∫ —à–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞  
- –≤–µ–±-—Å–µ—Ä–≤–µ—Ä  
